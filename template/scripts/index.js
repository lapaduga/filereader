
const readBtn=document.getElementById('read-btn');const output=document.querySelector('.mainscreen__output');const formSelect=document.getElementById('form-select');const form=document.querySelector('.form');let file='test.txt';document.addEventListener('DOMContentLoaded',()=>{makeSelect();});async function readInfo(arg){const result=await fetch(arg);return result.text();}
async function makeSelect(){let result=await readInfo(file);while(result.length>=1){let lengthRes=(result.substring(0,result.indexOf('\n')-1)).length;let val=result.substring(0,result.indexOf('&'));let str=result.substring(result.indexOf('&')+1,lengthRes);result=result.replace(result.substring(0,lengthRes+2),'');formSelect.innerHTML+=`<option value="${val}">${str}</option>`;}}
async function makeCheckbox(selectValue){let result=await readInfo(selectValue);output.textContent='';while(result.length>=1){let lengthRes=(result.substring(0,result.indexOf('\n')-1)).length;let str=result.substring(result.indexOf('&')+1,lengthRes);result=result.replace(result.substring(0,lengthRes+2),'');let label=document.createElement('label');let checkbox=document.createElement('input');let span=document.createElement('span');span.textContent=str;checkbox.type='checkbox';label.append(checkbox);label.append(span);output.append(label);}}
form.addEventListener('change',async e=>{if(e.target.closest('.form__select')){let select=e.target.closest('.form__select');if(select.value=='zero'){output.textContent='';}else{makeCheckbox(select.value);}}});let count=0;output.addEventListener('click',e=>{let input=e.target.closest('input');let amount=output.querySelectorAll('input').length;if(input){if(input.checked){count++;if(amount==count){document.querySelector('.pop').classList.add('active');}}else{count--;}}})
const no=document.getElementById('no');const yes=document.getElementById('yes');no.onclick=()=>{output.querySelectorAll('input').forEach(input=>{input.checked=false;});document.querySelector('.pop__title').textContent='Проверьте, какую задачу вы не закончили.';setTimeout(()=>document.querySelector('.pop').classList.remove('active'),2500);setTimeout(()=>document.querySelector('.pop__title').textContent='Вы уверены, что выполнили все задачи?',3500);count=0;let buttons=document.querySelector('.pop__bottom');buttons.style.display="none";setTimeout(()=>buttons.style.display="block",3500);};yes.onclick=()=>{document.querySelector('.pop__title').textContent='Выберите новую задачу.';setTimeout(()=>document.querySelector('.pop').classList.remove('active'),2500);setTimeout(()=>document.querySelector('.pop__title').textContent='Вы уверены, что выполнили все задачи?',3500);count=0;output.innerHTML='';let buttons=document.querySelector('.pop__bottom');buttons.style.display="none";setTimeout(()=>buttons.style.display="block",3500);}